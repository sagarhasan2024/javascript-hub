<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript Callback Functions Explained</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        h1 {
            color: #1a2a6c;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .subtitle {
            color: #b21f1f;
            font-size: 1.2rem;
            margin-bottom: 20px;
        }
        
        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        @media (max-width: 768px) {
            .content {
                grid-template-columns: 1fr;
            }
        }
        
        .explanation, .examples {
            background: rgba(255, 255, 255, 0.9);
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        h2 {
            color: #1a2a6c;
            margin-bottom: 15px;
            border-bottom: 2px solid #fdbb2d;
            padding-bottom: 10px;
        }
        
        h3 {
            color: #b21f1f;
            margin: 15px 0 10px;
        }
        
        p {
            margin-bottom: 15px;
        }
        
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            position: relative;
        }
        
        .code-title {
            background: #1a2a6c;
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            display: inline-block;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        
        .interactive-demo {
            margin-top: 20px;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 5px;
            border-left: 4px solid #1a2a6c;
        }
        
        button {
            background: #1a2a6c;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px 10px 0;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #b21f1f;
        }
        
        input, select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 5px;
            width: 200px;
        }
        
        .output {
            margin-top: 15px;
            padding: 10px;
            background: #e9e9e9;
            border-radius: 5px;
            min-height: 40px;
            font-family: 'Courier New', monospace;
        }
        
        .callback-visual {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .function-box {
            border: 2px solid #1a2a6c;
            border-radius: 10px;
            padding: 15px;
            width: 200px;
            margin: 10px;
            background: white;
            position: relative;
            text-align: center;
        }
        
        .function-box h4 {
            margin-bottom: 10px;
            color: #1a2a6c;
        }
        
        .callback-arrow {
            font-size: 24px;
            color: #1a2a6c;
            margin: 0 10px;
        }
        
        .callback-flow {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }
        
        .flow-step {
            background: white;
            border: 2px solid #1a2a6c;
            border-radius: 5px;
            padding: 10px 15px;
            margin: 5px 0;
            width: 80%;
            text-align: center;
        }
        
        .flow-arrow {
            font-size: 20px;
            color: #1a2a6c;
        }
        
        .highlight {
            background-color: #ffeb3b;
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        .note {
            background: #e7f3ff;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #1a2a6c;
            margin: 15px 0;
        }
        
        .warning {
            background: #ffeaa7;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #e17055;
            margin: 15px 0;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 10px 15px;
            cursor: pointer;
            background: #f1f1f1;
            border: 1px solid #ddd;
            border-bottom: none;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        
        .tab.active {
            background: #1a2a6c;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .callback-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .type-card {
            background: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .type-card h4 {
            color: #1a2a6c;
            margin-bottom: 10px;
        }
        
        .visualization {
            position: relative;
            height: 200px;
            border: 2px dashed #1a2a6c;
            border-radius: 10px;
            margin: 20px 0;
            background: #f8f9fa;
            overflow: hidden;
        }
        
        .function-call {
            position: absolute;
            width: 120px;
            padding: 10px;
            background: #1a2a6c;
            color: white;
            border-radius: 5px;
            text-align: center;
            animation: moveFunction 4s infinite;
        }
        
        @keyframes moveFunction {
            0% { top: 20px; left: 20px; }
            25% { top: 20px; left: calc(100% - 140px); }
            50% { top: calc(100% - 70px); left: calc(100% - 140px); }
            75% { top: calc(100% - 70px); left: 20px; }
            100% { top: 20px; left: 20px; }
        }
        
        .callback-execution {
            position: absolute;
            width: 120px;
            padding: 10px;
            background: #b21f1f;
            color: white;
            border-radius: 5px;
            text-align: center;
            animation: executeCallback 4s infinite;
            animation-delay: 2s;
        }
        
        @keyframes executeCallback {
            0% { top: calc(100% - 70px); left: 20px; opacity: 0; }
            25% { top: calc(100% - 70px); left: 20px; opacity: 1; }
            50% { top: 20px; left: 20px; opacity: 1; }
            75% { top: 20px; left: 20px; opacity: 0; }
            100% { top: calc(100% - 70px); left: 20px; opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>JavaScript Callback Functions Explained</h1>
            <p class="subtitle">Understanding how callback functions work in JavaScript</p>
        </header>
        
        <div class="content">
            <div class="explanation">
                <h2>What are Callback Functions?</h2>
                <p>A callback function is a function passed into another function as an argument, which is then invoked inside the outer function to complete some kind of routine or action.</p>
                
                <div class="callback-visual">
                    <div class="function-box">
                        <h4>Main Function</h4>
                        <p>Calls the callback</p>
                    </div>
                    <div class="callback-arrow">→</div>
                    <div class="function-box">
                        <h4>Callback Function</h4>
                        <p>Executed later</p>
                    </div>
                </div>
                
                <div class="visualization">
                    <div class="function-call">Function Call</div>
                    <div class="callback-execution">Callback Execution</div>
                </div>
                
                <h3>How Callbacks Work</h3>
                <p>In JavaScript, functions are first-class objects. This means they can be:</p>
                <ul>
                    <li>Stored in variables</li>
                    <li>Passed as arguments to other functions</li>
                    <li>Returned from functions</li>
                </ul>
                
                <div class="callback-flow">
                    <div class="flow-step">1. Define a callback function</div>
                    <div class="flow-arrow">↓</div>
                    <div class="flow-step">2. Pass it as an argument to another function</div>
                    <div class="flow-arrow">↓</div>
                    <div class="flow-step">3. The receiving function calls the callback at the right time</div>
                </div>
                
                <div class="tabs">
                    <div class="tab active" onclick="switchTab(event, 'sync-tab')">Synchronous</div>
                    <div class="tab" onclick="switchTab(event, 'async-tab')">Asynchronous</div>
                </div>
                
                <div id="sync-tab" class="tab-content active">
                    <h4>Synchronous Callbacks</h4>
                    <p>Executed immediately during the execution of the higher-order function.</p>
                    <div class="code-block">
<span class="code-title">Example: Array.map()</span>
const numbers = [1, 2, 3, 4, 5];

// Callback function
function double(num) {
    return num * 2;
}

// Passing callback to map
const doubled = numbers.map(double);
console.log(doubled); // [2, 4, 6, 8, 10]
                    </div>
                </div>
                
                <div id="async-tab" class="tab-content">
                    <h4>Asynchronous Callbacks</h4>
                    <p>Executed later, after an asynchronous operation completes.</p>
                    <div class="code-block">
<span class="code-title">Example: setTimeout()</span>
// Callback function
function sayHello() {
    console.log('Hello after 2 seconds!');
}

// Passing callback to setTimeout
setTimeout(sayHello, 2000);
console.log('This runs immediately');
                    </div>
                </div>
                
                <div class="note">
                    <strong>Key Point:</strong> Callbacks are essential for handling asynchronous operations in JavaScript, but they can lead to "callback hell" when nested too deeply.
                </div>
                
                <h3>Common Use Cases</h3>
                <div class="callback-types">
                    <div class="type-card">
                        <h4>Event Handlers</h4>
                        <p>DOM events like clicks, keypresses</p>
                    </div>
                    <div class="type-card">
                        <h4>Array Methods</h4>
                        <p>map, filter, forEach, reduce</p>
                    </div>
                    <div class="type-card">
                        <h4>Timers</h4>
                        <p>setTimeout, setInterval</p>
                    </div>
                    <div class="type-card">
                        <h4>API Requests</h4>
                        <p>fetch, XMLHttpRequest</p>
                    </div>
                </div>
            </div>
            
            <div class="examples">
                <h2>Interactive Examples</h2>
                
                <div class="interactive-demo">
                    <h3>Example 1: Basic Callback</h3>
                    <p>This example shows a simple callback function that processes user input.</p>
                    <div class="code-block">
function processUserInput(callback) {
    const name = prompt('Please enter your name:');
    callback(name);
}

function greetUser(name) {
    alert('Hello, ' + name + '!');
}

// Using the callback
processUserInput(greetUser);
                    </div>
                    <button onclick="runBasicCallback()">Run Basic Callback</button>
                    <div class="output" id="basic-output">Click the button to run the example</div>
                </div>
                
                <div class="interactive-demo">
                    <h3>Example 2: Array Methods with Callbacks</h3>
                    <p>This example demonstrates using callbacks with array methods.</p>
                    <div class="code-block">
const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];

// Using callbacks with array methods
const doubled = numbers.map(num => num * 2);
const evens = numbers.filter(num => num % 2 === 0);
const sum = numbers.reduce((total, num) => total + num, 0);

console.log('Original:', numbers);
console.log('Doubled:', doubled);
console.log('Evens:', evens);
console.log('Sum:', sum);
                    </div>
                    <button onclick="runArrayCallbacks()">Run Array Callbacks</button>
                    <div class="output" id="array-output">Click the button to see array operations</div>
                </div>
                
                <div class="interactive-demo">
                    <h3>Example 3: Asynchronous Callbacks</h3>
                    <p>This example shows how callbacks handle asynchronous operations.</p>
                    <div class="code-block">
function fetchData(callback) {
    console.log('Fetching data...');
    
    // Simulate API call with setTimeout
    setTimeout(() => {
        const data = { id: 1, name: 'John Doe', age: 30 };
        console.log('Data received:', data);
        callback(data);
    }, 2000);
}

function processUserData(user) {
    console.log('Processing:', user.name);
    console.log('User age:', user.age);
}

// Using the async callback
console.log('Start');
fetchData(processUserData);
console.log('End (this appears before data is processed)');
                    </div>
                    <button onclick="runAsyncCallback()">Run Async Callback</button>
                    <div class="output" id="async-output">Click the button to see async execution</div>
                </div>
                
                <div class="interactive-demo">
                    <h3>Example 4: Error-First Callbacks</h3>
                    <p>This example demonstrates the Node.js error-first callback pattern.</p>
                    <div class="code-block">
function readFile(callback) {
    const success = Math.random() > 0.3; // 70% success rate
    
    setTimeout(() => {
        if (success) {
            callback(null, 'File content: Hello World!');
        } else {
            callback('Error: File not found', null);
        }
    }, 1000);
}

// Using error-first callback
readFile((error, data) => {
    if (error) {
        console.error('Failed:', error);
    } else {
        console.log('Success:', data);
    }
});
                    </div>
                    <button onclick="runErrorFirstCallback()">Run Error-First Callback</button>
                    <div class="output" id="error-first-output">Click the button to test error handling</div>
                </div>
                
                <div class="interactive-demo">
                    <h3>Example 5: Callback Hell vs Solutions</h3>
                    <p>This example shows callback hell and how to avoid it.</p>
                    <div class="code-block">
<span class="code-title">Callback Hell (Pyramid of Doom)</span>
getUser(1, (user) => {
    getPosts(user.id, (posts) => {
        getComments(posts[0].id, (comments) => {
            displayComments(comments);
        });
    });
});

<span class="code-title">Solution: Named Functions</span>
function handleUser(user) {
    getPosts(user.id, handlePosts);
}

function handlePosts(posts) {
    getComments(posts[0].id, handleComments);
}

function handleComments(comments) {
    displayComments(comments);
}

getUser(1, handleUser);
                    </div>
                    <button onclick="showCallbackHell()">Show Callback Hell Problem</button>
                    <button onclick="showCallbackSolution()">Show Solution</button>
                    <div class="output" id="hell-output">Click buttons to see callback patterns</div>
                </div>
                
                <div class="warning">
                    <strong>Callback Hell Warning:</strong> Deeply nested callbacks can make code hard to read and maintain. Consider using Promises or async/await for complex async operations.
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality
        function switchTab(event, tabId) {
            // Remove active class from all tabs and tab contents
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Add active class to clicked tab and corresponding content
            event.currentTarget.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }
        
        // Example 1: Basic Callback
        function runBasicCallback() {
            const output = document.getElementById('basic-output');
            output.innerHTML = 'Check the browser for a prompt!';
            
            function processUserInput(callback) {
                const name = prompt('Please enter your name:');
                if (name) {
                    callback(name);
                }
            }

            function greetUser(name) {
                output.innerHTML = `Hello, ${name}!`;
            }

            processUserInput(greetUser);
        }
        
        // Example 2: Array Methods with Callbacks
        function runArrayCallbacks() {
            const output = document.getElementById('array-output');
            output.innerHTML = '';
            
            const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
            
            const log = (msg) => {
                console.log(msg);
                output.innerHTML += `${msg}<br>`;
            };
            
            // Using callbacks with array methods
            const doubled = numbers.map(num => num * 2);
            const evens = numbers.filter(num => num % 2 === 0);
            const sum = numbers.reduce((total, num) => total + num, 0);
            const squared = numbers.map(num => {
                return {
                    original: num,
                    squared: num * num
                };
            });
            
            log('Original: ' + numbers.join(', '));
            log('Doubled: ' + doubled.join(', '));
            log('Even numbers: ' + evens.join(', '));
            log('Sum: ' + sum);
            log('<br>Squared values:');
            squared.forEach(item => {
                log(`  ${item.original}² = ${item.squared}`);
            });
        }
        
        // Example 3: Asynchronous Callbacks
        function runAsyncCallback() {
            const output = document.getElementById('async-output');
            output.innerHTML = '';
            
            const log = (msg) => {
                console.log(msg);
                output.innerHTML += `${msg}<br>`;
            };
            
            function fetchData(callback) {
                log('Fetching data...');
                
                // Simulate API call with setTimeout
                setTimeout(() => {
                    const data = { id: 1, name: 'John Doe', age: 30 };
                    log('Data received: ' + JSON.stringify(data));
                    callback(data);
                }, 2000);
            }
            
            function processUserData(user) {
                log('Processing: ' + user.name);
                log('User age: ' + user.age);
            }
            
            log('Start');
            fetchData(processUserData);
            log('End (this appears before data is processed)');
        }
        
        // Example 4: Error-First Callbacks
        function runErrorFirstCallback() {
            const output = document.getElementById('error-first-output');
            output.innerHTML = '';
            
            const log = (msg) => {
                console.log(msg);
                output.innerHTML += `${msg}<br>`;
            };
            
            function readFile(callback) {
                const success = Math.random() > 0.3; // 70% success rate
                
                setTimeout(() => {
                    if (success) {
                        callback(null, 'File content: Hello World!');
                    } else {
                        callback('Error: File not found', null);
                    }
                }, 1000);
            }
            
            // Using error-first callback
            readFile((error, data) => {
                if (error) {
                    log('❌ Failed: ' + error);
                } else {
                    log('✅ Success: ' + data);
                }
            });
            
            log('Reading file...');
        }
        
        // Example 5: Callback Hell vs Solutions
        function showCallbackHell() {
            const output = document.getElementById('hell-output');
            output.innerHTML = `
                <strong>Callback Hell (Pyramid of Doom):</strong><br>
                <div class="code-block" style="margin: 10px 0; font-size: 0.9rem;">
getUser(1, (user) => {<br>
&nbsp;&nbsp;getPosts(user.id, (posts) => {<br>
&nbsp;&nbsp;&nbsp;&nbsp;getComments(posts[0].id, (comments) => {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;displayComments(comments);<br>
&nbsp;&nbsp;&nbsp;&nbsp;});<br>
&nbsp;&nbsp;});<br>
});
                </div>
                <strong>Problems:</strong><br>
                • Hard to read and understand<br>
                • Difficult to maintain<br>
                • Error handling becomes complex<br>
                • Leads to "Pyramid of Doom"
            `;
        }
        
        function showCallbackSolution() {
            const output = document.getElementById('hell-output');
            output.innerHTML = `
                <strong>Solution: Named Functions</strong><br>
                <div class="code-block" style="margin: 10px 0; font-size: 0.9rem;">
function handleUser(user) {<br>
&nbsp;&nbsp;getPosts(user.id, handlePosts);<br>
}<br><br>
function handlePosts(posts) {<br>
&nbsp;&nbsp;getComments(posts[0].id, handleComments);<br>
}<br><br>
function handleComments(comments) {<br>
&nbsp;&nbsp;displayComments(comments);<br>
}<br><br>
getUser(1, handleUser);
                </div>
                <strong>Benefits:</strong><br>
                • More readable and maintainable<br>
                • Easier error handling<br>
                • Reusable functions<br>
                • Better code organization
            `;
        }
        
        // Animation for the callback visualization
        function animateCallback() {
            const functionCall = document.querySelector('.function-call');
            const callbackExecution = document.querySelector('.callback-execution');
            
            // Reset animations
            functionCall.style.animation = 'none';
            callbackExecution.style.animation = 'none';
            
            // Trigger reflow
            void functionCall.offsetWidth;
            void callbackExecution.offsetWidth;
            
            // Restart animations
            functionCall.style.animation = 'moveFunction 4s infinite';
            callbackExecution.style.animation = 'executeCallback 4s infinite';
            callbackExecution.style.animationDelay = '2s';
        }
        
        // Start the animation when the page loads
        window.addEventListener('load', animateCallback);
        
        // Restart animation on tab focus
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                animateCallback();
            }
        });
    </script>
</body>
</html>